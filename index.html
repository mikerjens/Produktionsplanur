<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KRENKARIRNIR · Produktionsportal</title>
<style>
  :root{
    --bg:#0f1115;
    --card:#171922;
    --muted:#9aa3b2;
    --text:#e8ecf1;
    --brand:#7dd3fc;
    --brand2:#a78bfa;
    --border:#262a36;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:linear-gradient(180deg,#0d0f14 0%,#11141b 100%);
    color:var(--text);
    font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:.75rem;
    padding:16px 20px;
    border-bottom:1px solid var(--border);
    position:sticky;
    top:0;
    background:#0f1115cc;
    backdrop-filter: blur(6px);
    z-index:10;
  }
  .logo{
    display:flex;
    align-items:center;
    gap:.5rem;
    cursor:pointer;
    text-decoration:none;
    color:var(--text);
  }
  .logo .mark{
    width:32px;
    height:32px;
    border-radius:10px;
    background:conic-gradient(from 210deg,var(--brand),var(--brand2));
  }
  .logo h1{
    font-size:18px;
    letter-spacing:.4px;
    margin:0;
    font-weight:700;
  }
  .header-status{
    font-size:13px;
    color:var(--muted);
    text-align:right;
  }
  .header-status strong{color:#e5e7eb}
  .wrap{
    display:grid;
    grid-template-columns:320px 1fr 360px;
    gap:16px;
    padding:16px;
  }
  .card{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:16px;
    box-shadow:0 6px 24px rgba(0,0,0,.25);
  }
  .pane{padding:16px}
  h2{margin:.25rem 0 1rem 0;font-size:18px}
  h3{margin:1rem 0 .5rem 0;font-size:16px}
  label{
    display:block;
    margin-bottom:.5rem;
    font-size:13px;
    color:var(--muted);
  }
  select,input[type="search"]{
    width:100%;
    padding:12px;
    border-radius:12px;
    background:#0f1218;
    border:1px solid var(--border);
    color:var(--text);
    outline:none;
  }
  .tag{
    font-size:12px;
    padding:2px 8px;
    border-radius:999px;
    border:1px solid var(--border);
    color:var(--muted);
  }
  .list{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-top:12px;
  }
  .item{
    padding:12px;
    border:1px solid var(--border);
    border-radius:12px;
    background:#131623;
    display:flex;
    justify-content:space-between;
    align-items:center;
    cursor:pointer;
  }
  .item:hover{
    border-color:#2f3444;
    transform:translateY(-1px);
  }
  .muted{color:var(--muted)}
  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }
  .program{display:flex;flex-direction:column;gap:8px}
  .step{
    display:flex;
    gap:10px;
    align-items:flex-start;
    background:#121622;
    border:1px dashed #293042;
    padding:10px;
    border-radius:10px;
  }
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{
    padding:6px 10px;
    border-radius:999px;
    border:1px solid var(--border);
    background:#0f1218;
    font-size:12px;
  }
  .pill{
    padding:4px 10px;
    border-radius:999px;
    background:#0f1218;
    border:1px solid var(--border);
    font-size:12px;
  }
  .toolbar{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    margin-bottom:8px;
  }
  button{
    cursor:pointer;
    border:1px solid var(--border);
    background:#10131a;
    color:var(--text);
    padding:10px 12px;
    border-radius:12px;
    font-size:13px;
  }
  button.primary{
    border-color:transparent;
    background:linear-gradient(135deg,var(--brand),var(--brand2));
  }
  .section{
    border-top:1px solid var(--border);
    margin-top:12px;
    padding-top:12px;
  }
  .empty{
    padding:16px;
    text-align:center;
    color:var(--muted);
  }
  .kicker{
    font-size:12px;
    color:var(--muted);
    letter-spacing:.3px;
    text-transform:uppercase;
  }
  .stack{display:flex;flex-direction:column;gap:10px}
  .two{
    display:grid;
    grid-template-columns:1.2fr .8fr;
    gap:16px;
  }
  .daybtn{
    width:100%;
    text-align:left;
  }
  .contact-row{
    display:flex;
    justify-content:space-between;
    gap:8px;
    padding:10px;
    border:1px solid var(--border);
    border-radius:10px;
    background:#101421;
  }
  .scroll{
    max-height:62vh;
    overflow:auto;
    padding-right:6px;
  }
  .search{display:flex;gap:8px;margin-top:8px}
  .footer{
    padding:10px 16px;
    color:var(--muted);
    font-size:12px;
    text-align:center;
  }
  a{color:#a5b4fc}
  .status-card{
    padding:10px 12px;
    border-radius:12px;
    background:linear-gradient(135deg,rgba(125,211,252,0.07),rgba(167,139,250,0.07));
    border:1px solid #1f2937;
    margin-bottom:10px;
    font-size:13px;
  }
  .status-bar{
    height:6px;
    border-radius:999px;
    background:#111827;
    overflow:hidden;
    margin-top:6px;
  }
  .status-fill{
    height:100%;
    border-radius:999px;
    background:linear-gradient(90deg,var(--brand),var(--brand2));
    width:0;
    transition:width .5s ease-out;
  }

  @media (max-width:1100px){
    .wrap{grid-template-columns:1fr;}
    .right{order:3}
    .center{order:2}
    .left{order:1}
  }

  /* Modal */
  .modal{
    display:none;
    position:fixed;
    inset:0;
    background:#0009;
    z-index:50;
    align-items:center;
    justify-content:center;
  }
  .modal .box{
    width:min(1000px,94vw);
    max-height:86vh;
    overflow:auto;
  }
  .modal .hdr{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    position:sticky;
    top:0;
    background:var(--card);
    padding-bottom:8px;
    margin-bottom:8px;
  }

  /* Print */
  @media print{
    body{background:white;color:black}
    header,.left,.right,.footer,#contactsModal{display:none !important}
    .center{border:none;box-shadow:none}
    #callSheetsModal{display:block;background:none}
    #callSheetsModal .box{width:100%;max-height:none;overflow:visible}
    #callSheetsList .sheet{page-break-after:always;border:1px solid #0002}
    .sheet .program .step{border:1px solid #0001;background:#fff}
    a{color:inherit}
  }
</style>
</head>
<body>
<header>
  <a class="logo" onclick="resetUI()" title="Til start">
    <span class="mark"></span>
    <h1>KRENKARIRNIR · Produktionsportal</h1>
  </a>
  <div class="header-status">
    <div class="kicker">Optagestatus</div>
    <div id="headerSceneStats"><strong>–</strong></div>
  </div>
</header>

<div class="wrap">
  <!-- VENSTRE -->
  <div class="card pane left">
    <div class="status-card">
      <div class="kicker">Status for scener</div>
      <div id="sceneStatsText">–</div>
      <div class="status-bar">
        <div id="sceneStatsFill" class="status-fill"></div>
      </div>
    </div>

    <div class="toolbar">
      <button class="primary" onclick="openContacts()">Kontakter</button>
      <button onclick="openCallSheets()">Call sheets</button>
      <button onclick="window.print()">Print</button>
    </div>

    <div class="section">
      <label for="nameSelect">Vælg dit navn</label>
      <select id="nameSelect" onchange="renderMySchedule()">
        <option value="">— Vælg person —</option>
      </select>
    </div>

    <div class="section">
      <div class="kicker">Mit skema (kommende dage)</div>
      <div id="mySchedule" class="stack"></div>
    </div>
  </div>

  <!-- MIDTEN -->
  <div class="card pane center">
    <div class="two">
      <div>
        <div class="kicker">Valgt dag</div>
        <h2 id="dayTitle">Vælg en dag i højre side</h2>
        <div id="dayMeta" class="chips"></div>

        <div class="section">
          <h3>Program</h3>
          <div id="program" class="program"></div>
        </div>

        <div class="section grid">
          <div>
            <h3>Skuespillere</h3>
            <div id="cast" class="chips"></div>
          </div>
          <div>
            <h3>Crew</h3>
            <div id="crew" class="chips"></div>
          </div>
        </div>
      </div>

      <div>
        <h3>Call sheet</h3>
        <div id="callInfo" class="stack">
          <div class="muted">Ingen ekstern PDF er tilknyttet. Brug programmet og call sheet oversigten.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- HØJRE -->
  <div class="card pane right">
    <div class="kicker">Kommende produktionsdage</div>
    <div class="search">
      <input id="daySearch" type="search" placeholder="Søg dato, sted, titel…" oninput="renderDayList()">
    </div>
    <div id="dayList" class="list scroll"></div>
  </div>
</div>

<!-- Kontakter modal -->
<div id="contactsModal" class="modal">
  <div class="card pane box">
    <div class="hdr">
      <h2 style="margin:0">Kontakter (resterende optagelser)</h2>
      <div class="toolbar">
        <button onclick="closeContacts()">Luk</button>
      </div>
    </div>
    <div class="search">
      <input id="contactSearch" type="search" placeholder="Søg navn, rolle, e-mail, tlf…" oninput="renderContacts()">
    </div>
    <div id="contactsList" class="stack section"></div>
  </div>
</div>

<!-- Call sheets modal -->
<div id="callSheetsModal" class="modal">
  <div class="card pane box">
    <div class="hdr">
      <h2 style="margin:0">Call sheets · fuld dagsplan pr. dag</h2>
      <div class="toolbar">
        <button onclick="window.print()">Print</button>
        <button onclick="closeCallSheets()">Luk</button>
      </div>
    </div>
    <div class="search">
      <input id="callSearch" type="search" placeholder="Søg (dato, titel, location, person…)" oninput="renderCallSheets()">
    </div>
    <div id="callSheetsList" class="stack section"></div>
  </div>
</div>

<div class="footer">
  Version: 3.3 · Kilde: Produktionsplan (vers. 3.3) · KRENKARIRNIR
</div>

<script>
/* -------------------- DATA (vers. 3.3) -------------------- */

/* Kommende optagedage (ikke completed) */
const UPCOMING_DAYS = [
  {
    id:"2025-12-07",
    title:"Søndag 7. dec. · Parkeringsscene",
    location:"Studenterskolen i Hoydølum",
    program:[
      ["09:00","Crew møder (Thomas, Michael)"],
      ["09:00","Make-up gør skuespillere klar (Julia)"],
      ["09:00","Skuespillere møder i Hugskotið (Hans Tórgarð, Esther á Fjallinum)"],
      ["10:30","Optagelse af parkeringsscene starter"],
      ["11:30","Hans får fri"],
      ["15:00","Esther får fri"],
      ["15:00","Crew får fri"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð"],
    crew:["Michael Koba","Thomas Koba","Julia Jacobsen"],
    call:null
  },
  {
    id:"2025-12-14",
    title:"Søndag 14. dec. · Flashback 3B kaffemaskine-scene",
    location:"Tjarnir (Presselogen)",
    program:[
      ["15:00","Film crew gør kaffemaskine-scenen klar (Hans Petur, Thomas, Michael)"],
      ["15:00","Lyd, props & design og make-up møder (Ronni, Anna Kristin, Julia)"],
      ["15:00","2 statister (girl 1 og girl 2) og 1 hovedskuespiller møder til make-up og tøj (Helena, ukendt kvindelig statist, Hjálmar Dam)"],
      ["17:00","Optagelse starter"],
      ["20:30","SLUT"]
    ],
    cast:["Helena","Ukendt kvindelig statist","Hjálmar Dam"],
    crew:["Michael Koba","Thomas Koba","Hans Petur Hansen","Anna Kristin Bæk","Ronni Poulsen","Julia Jacobsen"],
    call:null
  }
];

/* Allerede completed optagedage (arkiv) */
const COMPLETED_DAYS = [
  {
    id:"2025-11-23",
    title:"Søndag 23. nov. · Terapilokale (fortsat)",
    location:"Aulan, Studenterskolen i Hoydølum",
    program:[
      ["07:00","Make-up møder (Julia). Producer møder (Michael)"],
      ["07:00","Skuespiller Ruth møder (Elsa Maria)"],
      ["07:40","Skuespiller Johanna møder (Esther á Fjallinum)"],
      ["08:15","Skuespiller Líggjas møder (Bjørn Ulvedal)"],
      ["08:25","Skuespiller Danny møder (Marius)"],
      ["08:35","Skuespiller Høgni møder (Hjálmar Dam)"],
      ["08:45","Skuespiller Holgar møder (Hans Tórgarð)"],
      ["09:00","Filmoptagelse starter"],
      ["09:00","Make-up får fri (Julia Jacobsen)"],
      ["12:00","Frokost"],
      ["12:30","Optagelse fortsætter"],
      ["13:30","Alt slut"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð","Elsa Maria Magnusardóttir Olsen","Hjálmar Dam","Marius DC","Bjørn Simonsen Ulvedal"],
    crew:["Michael Koba","Thomas Koba","Julia Jacobsen","Jónfinn Stenberg","Hans Petur Hansen","Høgni Fagraberg"],
    call:null
  },
  {
    id:"2025-11-22",
    title:"Lørdag 22. nov. · Terapilokale",
    location:"Aulan, Studenterskolen i Hoydølum",
    program:[
      ["06:00","Make-up møder (Julia). Producer møder (Michael). Ruth møder (Elsa)"],
      ["06:40","Skuespiller Johanna møder (Esther á Fjallinum)"],
      ["07:00","Morgenmad kaffe/te og rundstykker"],
      ["07:15","Skuespiller Líggjas møder (Bjørn Ulvedal)"],
      ["07:25","Skuespiller Danny møder (Marius)"],
      ["07:35","Skuespiller Høgni møder (Hjálmar Dam)"],
      ["07:45","Skuespiller Holgar møder (Hans Tórgarð)"],
      ["08:00","Filmoptagelse starter"],
      ["09:00","Make-up får fri (Julia Jacobsen)"],
      ["10:30","Pause / kaffe og sødt"],
      ["10:45","Optagelser starter igen"],
      ["12:20","Frokost"],
      ["13:10","Optagelse fortsætter"],
      ["14:45","Pause / kaffe"],
      ["15:10","Optagelser fortsætter"],
      ["17:00","SLUT"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð","Elsa Maria Magnusardóttir Olsen","Hjálmar Dam","Marius DC","Bjørn Simonsen Ulvedal"],
    crew:["Michael Koba","Thomas Koba","Julia Jacobsen","Jónfinn Stenberg","Hans Petur Hansen","Høgni Fagraberg"],
    call:null
  },
  {
    id:"2025-11-10",
    title:"Mandag 10. nov. · Office scene",
    location:"Studenterskolen i Hoydølum",
    program:[
      ["11:30","Crew møder (Hans Petur, Thomas, Anna Kristin, Michael)"],
      ["11:30","Make-up gør skuespillere klar (Julia)"],
      ["11:30","Skuespillere møder (Hans Tórgarð, Thora, Esther)"],
      ["13:15","Politibetjent A møder på sættet"],
      ["13:30","Optagelse af office-scene starter"],
      ["14:30","Office-scene slut"],
      ["15:30","Skuespiller Óluva møder (civil politi)"],
      ["15:40","Scene optages med civil politibetjent"],
      ["17:45","Óluva får fri"],
      ["18:00","Optagelse af alle scener slut"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð","Thora Augustinussen","Politibetjent A","Óluva Gunnarsdóttir"],
    crew:["Michael Koba","Thomas Koba","Hans Petur Hansen","Anna Kristin Bæk","Julia Jacobsen"],
    call:null
  },
  {
    id:"2025-11-02",
    title:"Søndag 2. nov. · Terapilokale (fortsat)",
    location:"Aulan, Studenterskolen i Hoydølum",
    program:[
      ["08:00","Optagelser fortsætter fra 1. november (terapisessioner)"],
      ["18:00","SLUT (forventet)"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð","Elsa Maria Magnusardóttir Olsen","Hjálmar Dam","Marius DC","Bjørn Simonsen Ulvedal"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Hans Petur Hansen","Anna Kristin Bæk","Høgni Fagraberg","Julia Jacobsen"],
    call:null
  },
  {
    id:"2025-11-01",
    title:"Lørdag 1. nov. · Terapilokale",
    location:"Aulan, Studenterskolen i Hoydølum",
    program:[
      ["06:00","Make-up møder (Julia). Props & design møder (Anna Kristin). Producer møder (Michael)"],
      ["06:00","Skuespiller Ruth møder (Elsa Maria)"],
      ["06:40","Skuespiller Johanna møder (Esther á Fjallinum)"],
      ["07:00","Morgenmad kaffe/te og rundstykker"],
      ["07:15","Skuespiller Líggjas møder (Bjørn Ulvedal)"],
      ["07:25","Skuespiller Danny møder (Marius)"],
      ["07:35","Skuespiller Høgni møder (Hjálmar Dam)"],
      ["07:45","Skuespiller Holgar møder (Hans Tórgarð)"],
      ["08:00","Filmoptagelse starter"],
      ["09:00","Make-up får fri (Julia Jacobsen)"],
      ["10:30","Pause / kaffe og sødt"],
      ["10:45","Optagelser starter igen"],
      ["12:20","Frokost"],
      ["13:10","Optagelser fortsætter"],
      ["13:30","Props & design får fri (Anna Kristin)"],
      ["15:00","Pause / kaffe"],
      ["15:15","Optagelser fortsætter"],
      ["19:00","SLUT"]
    ],
    cast:["Esther á Fjallinum","Hans Tórgarð","Elsa Maria Magnusardóttir Olsen","Hjálmar Dam","Marius DC","Bjørn Simonsen Ulvedal"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Hans Petur Hansen","Anna Kristin Bæk","Høgni Fagraberg","Julia Jacobsen"],
    call:null
  },
  {
    id:"2025-10-21",
    title:"Tirsdag 21. okt. · Esther hjemme-scene",
    location:"Dr. Dahlsgøta 15, Tórshavn",
    program:[
      ["15:00","Crew møder (Hans Petur, Thomas, Ronni, Guðrun)"],
      ["16:00","Skuespillere møder (Aksel í Botni, Esther á Fjallinum). Anna Kristin ordner tøj"],
      ["16:00","Julia møder og ordner make-up og hår"],
      ["18:00","Julia får fri"],
      ["18:05","Optagelse starter"],
      ["21:30","SLUT"]
    ],
    cast:["Aksel í Botni","Esther á Fjallinum"],
    crew:["Michael Koba","Thomas Koba","Hans Petur Hansen","Anna Kristin Bæk","Ronni Poulsen","Julia Jacobsen","Jónfinn Stenberg","Guðrun Joensen","Katrin Kallsberg"],
    call:null
  },
  {
    id:"2025-10-19",
    title:"Søndag 19. okt. · Flashback 4 – Ruth flirter med tjener",
    location:"Hotel Brandan · Rest. Húsagarður og køkken",
    program:[
      ["17:00","Lysafdeling, instruktør og producer møder (Hans Petur, Thomas, Michael)"],
      ["17:45","Props & design møder (Anna Kristin). Lyd (Ronni) og make-up (Julia) møder. Skuespillere (Elsa Maria, Tórur, Jaspur) møder"],
      ["18:30","Optagelse begynder"],
      ["21:30","SLUT"]
    ],
    cast:["Elsa Maria Magnusardóttir Olsen","Tórur Árnastein","Jaspur Jørgensen","Van Yancy Nacua"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Hans Petur Hansen","Anna Kristin Bæk","Julia Jacobsen"],
    call:null
  },
  {
    id:"2025-09-23",
    title:"Tirsdag 23. sept. · Flashback 1A – Sirkus",
    location:"Sirkus bar",
    program:[
      ["16:00","Teknisk crew gør scenen klar (Hans Petur, Thomas, Jónfinn)"],
      ["18:15","Alle skuespillere møder til make-up og tøj (Marius DC, Hanna, Inga, Súsanna)"],
      ["19:30","Optagelse i Sirkus starter"],
      ["21:00","SLUT"]
    ],
    cast:["Marius DC","Hanna Flóvinsdóttir","Inga Greve Klemensen","Súsanna Laursen","Benjamin","Olivur","Andras"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Hans Petur Hansen","Julia Jacobsen","Sunneva Háberg Eysturstein"],
    call:null
  },
  {
    id:"2025-09-30",
    title:"Tirsdag 30. sept. · Flashback 1B – Dannys flirt",
    location:"Studio 016, Hotel Føroyar",
    program:[
      ["16:00","Teknisk crew gør scenen klar (Hans Petur, Thomas, Jónfinn, Anna Kristin)"],
      ["16:00","Skuespillere møder til make-up og tøj (Marius DC, Hanna)"],
      ["19:00","Optagelse starter"],
      ["21:30","SLUT"]
    ],
    cast:["Marius DC","Hanna Flóvinsdóttir"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Hans Petur Hansen","Anna Kristin Bæk","Julia Jacobsen","Rósa Maria Restorfff"],
    call:null
  },
  {
    id:"2025-10-07",
    title:"Tirsdag 7. okt. · Flashback 2 – Festen med Líggjas",
    location:"Hvarvið 3, kj., Tórshavn",
    program:[
      ["14:00","Crew gør scenen klar (Hans Petur, Thomas, Michael, Anna Kristin, Ronni, Guðrun)"],
      ["15:15","Alle skuespillere møder til make-up i Hugskotið (Bjørn, Lív Bruun, Ása, Edwin) og transporteres til location"],
      ["15:15","Julia møder i Hugskotið og sørger for make-up (fri ca. 17:15)"],
      ["16:30","Optagelse påbegyndes på location"],
      ["19:00","SLUT"]
    ],
    cast:["Bjørn Simonsen Ulvedal","Lív Bruun Muller","Ása Helena Brynjardóttir","Edvin Niclasen"],
    crew:["Michael Koba","Thomas Koba","Hans Petur Hansen","Anna Kristin Bæk","Julia Jacobsen","Petur Háberg"],
    call:null
  },
  {
    id:"2025-10-13",
    title:"Mandag 13. okt. · Flashback 3A – advokat scene",
    location:"Tjarnir",
    program:[
      ["15:00","Film crew gør advokat-scenen klar (Hans Petur, Thomas, Jónfinn, Ronni, Michael)"],
      ["16:00","Props & design og make-up møder (Anna Kristin forbereder tøj, Julia laver make-up)"],
      ["16:00","2 statister og 1 hovedskuespiller møder til make-up (Tórur við Áir, Astrið Gullborgardóttir, Hjálmar Dam)"],
      ["17:00","Optagelse starter"],
      ["19:00","SLUT"]
    ],
    cast:["Tórur við Áir","Astrið Gullborgardóttir","Hjálmar Dam"],
    crew:["Michael Koba","Thomas Koba","Jónfinn Stenberg","Anna Kristin Bæk","Ronni Poulsen","Julia Jacobsen"],
    call:null
  }
];

/* Kontakter – kun folk der er med på de resterende optagedage */
const CONTACTS = {
  "Esther á Fjallinum":{role:"Skuespiller · Johanna", email:"estherafjallinum@gmail.com", phone:"265069"},
  "Hans Tórgarð":{role:"Skuespiller · Holgar", email:"hanstorgar@gmail.com", phone:"229342"},
  "Helena":{role:"Statist · Høgni – girl 1", email:"helena.h.jorgensen@gmail.com", phone:"274450"},
  "Ukendt kvindelig statist":{role:"Statist · Høgni – girl 2"},
  "Hjálmar Dam":{role:"Skuespiller · Høgni Nielsen", email:"helmetsdam@gmail.com", phone:"512449"},
  "Michael Koba":{role:"Producer", email:"mk@fixer.fo", phone:"591011"},
  "Thomas Koba":{role:"Instruktør / kamera", email:"thomas@kovboyfilm.com", phone:"213457"},
  "Julia Jacobsen":{role:"Make-up", email:"juliajacobsen@outlook.com", phone:"251175"},
  "Hans Petur Hansen":{role:"Lys", email:"hph@kvf.fo", phone:"296652"},
  "Anna Kristin Bæk":{role:"Props & design", email:"kristin.baek@gmail.com", phone:"265180"},
  "Ronni Poulsen":{role:"Lyd", email:"ronni.poulsen@gmail.com", phone:"794141"}
};

/* Flag scener som completed/ikke completed */
UPCOMING_DAYS.forEach(d => d.completed = false);
COMPLETED_DAYS.forEach(d => d.completed = true);

/* Alle scener samlet (til statistik + call sheets) */
const ALL_SCENES = [...UPCOMING_DAYS, ...COMPLETED_DAYS];

/* Udledte navne til dropdown */
const PEOPLE = Array.from(new Set([
  ...Object.keys(CONTACTS),
  ...UPCOMING_DAYS.flatMap(d => [...d.cast, ...d.crew])
])).sort((a,b)=>a.localeCompare(b,'da'));

/* -------------------- DOM helpers -------------------- */
const el = id => document.getElementById(id);
let currentDay = null;

/* -------------------- INIT -------------------- */
function init(){
  const sel = el('nameSelect');
  PEOPLE.forEach(p=>{
    const o = document.createElement('option');
    o.value=p;
    o.textContent=p;
    sel.appendChild(o);
  });
  renderDayList();
  renderMySchedule();
  renderContacts();
  renderCallSheets();
  updateSceneStats();
}
init();

/* -------------------- UI base -------------------- */
function resetUI(){
  el('nameSelect').value="";
  renderMySchedule();
  currentDay = null;
  el('dayTitle').textContent = 'Vælg en dag i højre side';
  el('dayMeta').innerHTML = '';
  el('program').innerHTML = '';
  el('cast').innerHTML = '';
  el('crew').innerHTML = '';
  el('callInfo').innerHTML = '<div class="muted">Ingen ekstern PDF er tilknyttet. Brug programmet og call sheet oversigten.</div>';
  renderDayList();
  window.scrollTo({top:0,behavior:'smooth'});
}

/* Hent scene-dag uanset completed eller ej */
function getSceneById(dayId){
  return ALL_SCENES.find(x => x.id === dayId) || null;
}

/* -------------------- Dagsliste (højre – kun kommende) -------------------- */
function renderDayList(){
  const q = (el('daySearch').value || '').toLowerCase();
  const list = el('dayList');
  list.innerHTML = '';
  const days = [...UPCOMING_DAYS].sort((a,b)=>a.id.localeCompare(b.id));
  days.forEach(d=>{
    if(q && !(d.title.toLowerCase().includes(q) || d.location.toLowerCase().includes(q))) return;
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML = `
      <div>
        <div><strong>${d.title}</strong></div>
        <div class="muted">${d.location}</div>
      </div>
      <span class="tag">Se program</span>`;
    div.onclick = ()=>showDay(d.id);
    list.appendChild(div);
  });
  if(!list.children.length){
    list.innerHTML = '<div class="empty">Ingen kommende dage matcher din søgning.</div>';
  }
}

function showDay(dayId){
  const d = getSceneById(dayId);
  if(!d) return;
  currentDay = d.id;

  el('dayTitle').textContent = d.title;
  el('dayMeta').innerHTML = `
    <span class="pill">Location: ${d.location}</span>
    <span class="pill">Skuespillere: ${d.cast.length}</span>
    <span class="pill">Crew: ${d.crew.length}</span>
    <span class="pill">${d.completed ? 'Status: completed' : 'Status: planlagt'}</span>
  `;

  const prog = el('program');
  prog.innerHTML = '';
  if(!d.program || !d.program.length){
    prog.innerHTML = '<div class="empty">Intet program registreret.</div>';
  } else {
    d.program.forEach(([t,desc])=>{
      const row = document.createElement('div');
      row.className='step';
      row.innerHTML = `<time class="tag">${t}</time><div>${desc}</div>`;
      prog.appendChild(row);
    });
  }

  el('cast').innerHTML = d.cast.length
    ? d.cast.map(n=>`<span class="chip" title="${contactTip(n)}">${n}</span>`).join('')
    : '<div class="muted">–</div>';

  el('crew').innerHTML = d.crew.length
    ? d.crew.map(n=>`<span class="chip" title="${contactTip(n)}">${n}</span>`).join('')
    : '<div class="muted">–</div>';

  el('callInfo').innerHTML = d.call
    ? `<a href="${d.call}" target="_blank">Åbn ekstern call sheet (PDF)</a>`
    : '<div class="muted">Ingen ekstern PDF er tilknyttet.</div>';

  if(window.innerWidth<1100){
    document.querySelector('.center').scrollIntoView({behavior:'smooth'});
  }
}

/* -------------------- Mit skema (kun kommende dage) -------------------- */
function renderMySchedule(){
  const name = el('nameSelect').value;
  const box = el('mySchedule');
  box.innerHTML='';
  if(!name){
    box.innerHTML = '<div class="empty">Vælg dit navn for at se dine kommende arbejdsdage.</div>';
    return;
  }
  const mine = [...UPCOMING_DAYS]
    .sort((a,b)=>a.id.localeCompare(b.id))
    .filter(d => d.cast.includes(name) || d.crew.includes(name));
  if(!mine.length){
    box.innerHTML = '<div class="empty">Ingen kommende dage fundet for denne person.</div>';
    return;
  }
  mine.forEach(d=>{
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML = `
      <div>
        <div><strong>${d.title}</strong></div>
        <div class="muted">${d.location}</div>
      </div>
      <button class="daybtn">Åbn</button>`;
    div.onclick = ()=>showDay(d.id);
    box.appendChild(div);
  });
}

/* -------------------- Kontakter -------------------- */
function contactTip(name){
  const c = CONTACTS[name];
  if(!c) return '';
  const bits = [c.role, c.email, c.phone].filter(Boolean);
  return bits.join(' · ');
}

function openContacts(){
  el('contactsModal').style.display='flex';
  renderContacts();
}
function closeContacts(){
  el('contactsModal').style.display='none';
}

function renderContacts(){
  const q = (el('contactSearch')?.value || '').toLowerCase();
  const root = el('contactsList');
  root.innerHTML='';
  const rows = Object.entries(CONTACTS)
    .filter(([name,c])=>{
      const hay = [name,c.role||'',c.email||'',c.phone||''].join(' ').toLowerCase();
      return !q || hay.includes(q);
    })
    .sort((a,b)=>a[0].localeCompare(b[0],'da'));
  if(!rows.length){
    root.innerHTML='<div class="empty">Ingen kontakter matcher.</div>';
    return;
  }
  rows.forEach(([name,c])=>{
    const div = document.createElement('div');
    div.className='contact-row';
    const role = c.role? `<div class="muted">${c.role}</div>` : '';
    const mail = c.email? `<a href="mailto:${c.email}">${c.email}</a>` : '<span class="muted">—</span>';
    const tel  = c.phone? `<a href="tel:${c.phone}">${c.phone}</a>` : '<span class="muted">—</span>';
    div.innerHTML = `
      <div>
        <div><strong>${name}</strong></div>
        ${role}
      </div>
      <div style="text-align:right">
        <div>${mail}</div>
        <div>${tel}</div>
      </div>`;
    root.appendChild(div);
  });
}

/* -------------------- Call sheets (alle scener) -------------------- */
function openCallSheets(){
  el('callSheetsModal').style.display='flex';
  renderCallSheets();
}
function closeCallSheets(){
  el('callSheetsModal').style.display='none';
}

function renderCallSheets(){
  const q = (el('callSearch')?.value || '').toLowerCase();
  const root = el('callSheetsList');
  root.innerHTML='';
  const days = [...ALL_SCENES].sort((a,b)=>a.id.localeCompare(b.id));
  days.forEach(d=>{
    const hay = [
      d.id,
      d.title,
      d.location,
      ...d.cast,
      ...d.crew,
      ...(d.program?.flat() || [])
    ].join(' ').toLowerCase();
    if(q && !hay.includes(q)) return;

    const statusLabel = d.completed ? 'Completed' : 'Planlagt';
    const statusClass = d.completed ? 'pill' : 'pill';

    const sheet = document.createElement('div');
    sheet.className='sheet';
    sheet.style.border='1px solid var(--border)';
    sheet.style.borderRadius='12px';
    sheet.style.padding='16px';
    sheet.style.background='#111521';
    sheet.innerHTML = `
      <div class="kicker">${d.id}</div>
      <h2 style="margin:.25rem 0 0 0">${d.title}</h2>
      <div class="chips" style="margin:.5rem 0 1rem 0">
        <span class="pill">Location: ${d.location}</span>
        <span class="pill">Skuespillere: ${d.cast.length}</span>
        <span class="pill">Crew: ${d.crew.length}</span>
        <span class="${statusClass}">Status: ${statusLabel}</span>
      </div>
      <div class="section">
        <h3>Program</h3>
        <div class="program">
          ${
            d.program && d.program.length
              ? d.program.map(([t,desc]) =>
                  `<div class="step"><time class="tag">${t}</time><div>${desc}</div></div>`
                ).join('')
              : '<div class="muted">Intet program registreret.</div>'
          }
        </div>
      </div>
      <div class="section grid">
        <div>
          <h3>Skuespillere</h3>
          <div class="chips">
            ${
              d.cast.length
                ? d.cast.map(n=>`<span class="chip" title="${contactTip(n)}">${n}</span>`).join('')
                : '<div class="muted">–</div>'
            }
          </div>
        </div>
        <div>
          <h3>Crew</h3>
          <div class="chips">
            ${
              d.crew.length
                ? d.crew.map(n=>`<span class="chip" title="${contactTip(n)}">${n}</span>`).join('')
                : '<div class="muted">–</div>'
            }
          </div>
        </div>
      </div>
    `;
    root.appendChild(sheet);
  });

  if(!root.children.length){
    root.innerHTML = '<div class="empty">Ingen dage matcher din søgning.</div>';
  }
}

/* -------------------- Statistik: scener completed i % -------------------- */
function updateSceneStats(){
  const total = ALL_SCENES.length;
  const completed = ALL_SCENES.filter(d=>d.completed).length;
  const remaining = total - completed;
  const completedPct = total ? Math.round((completed/total)*100) : 0;
  const remainingPct = 100 - completedPct;

  const text = `Der er optaget ${completed} ud af ${total} planlagte scener (${completedPct}% completed · ${remainingPct}% tilbage).`;
  el('sceneStatsText').textContent = text;
  el('headerSceneStats').innerHTML = `<strong>${completedPct}% completed</strong> · ${remainingPct}% tilbage`;

  const fill = el('sceneStatsFill');
  fill.style.width = completedPct + '%';
}
</script>
</body>
</html>
